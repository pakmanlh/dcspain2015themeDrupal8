<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>Theming in Drupal 8: un soplo de aire fresco.</title>

		<meta name="description" content="Slides de la charla «Theming in Drupal 8: un soplo de aire fresco.» para la DrupalCamp Spain 2015">
		<meta name="author" content="Pako Garcia">

		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/ymbra.css" id="theme">
		<link rel="stylesheet" href="css/font-awesome.min.css">

		<!-- Code syntax highlighting -->
		<link rel="stylesheet" href="lib/css/zenburn.css">
		<link rel="stylesheet" href="lib/css/prism.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">
			<span class="hashtag"><i class="fa fa-twitter"></i>#DrupalCampSpain2015</span>

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">
				<section class="intro" data-background="images/climate-cold-glacier-iceberg-large.jpg">
					<h1>Theming in Drupal 8</h1>
					<h2>«un soplo de aire fresco»</h2>
				</section>

				<section>
					<h2>¿Quien soy? ¿De dónde vengo?</h2>
					<h3>Pako Garcia</h3>
					<p>
						<small><a href="http://ymbra.com">Vegan Frontend developer at <img src="images/logo-ymbra.png" class="logo-ymbra"></a><br><a href="http://twitter.com/pakmanlh"> @pakmanlh</a> in the internets</small>
				</section>

				<section>
					<h2>¿A todos nos gustan los ponies?</h2>
					<p>
						<img src="images/ponie.png" />
					</p>
				</section>

				<section>
					<h2>Recomendaciones del cheff:</h2>
					<ul>
					<li><strong>10:30 to 11:30</strong><br> Render API en Drupal 7 & 8 <br> <em>Jose Luis Bellido</em></li>
					<li><strong>12:00 to 13:00</strong><br> Drupal 8 Frontend for Backenders <br> <em>Lauri Eskola</em></li>
					</ul>
				</section>

				<!-- Example of nested vertical slides -->
				<section>
					<section data-background="images/broken-car-vehicle-rust.jpeg">
						<h1 style="background: none">Cualquier tiempo pasado fue mejor...</h1>
						<h3 style="color: white">¿seguro?</h3>
					</section>
					<section>
					    <h1>Divitis</h1>
					    <h3>Marcado enriquecido <sup>tm</sup></h3>
					    <pre><code data-trim contenteditable>
<div class="foo bar baz whatever">
 <div class="foo bar baz whatever">
  <div class="foo bar baz whatever">
   <h1 class="pane-title">Hola! soy el marcado de Drupal</h1>
   <div class="node node-type node-viewmode-argh">
    Otro div más, porque no...
    </div>
   </div>
 </div>
</div>
					    </code></pre>
				  </section>
				  <section>
					    <h1>sobrecarga css</h1>
					  </section>

					  <section id="csslove">
					    <small>27 archivos css en Stark de Drupal 7</small>
					    <pre><code data-trim contenteditable class="max">
<style media="all">
  @import url("sites/modules/system/system.base.css?mz4mz0");
  @import url("sites/modules/system/system.menus.css?mz4mz0");
  @import url("sites/modules/system/system.messages.css?mz4mz0");
  @import url("sites/modules/system/system.theme.css?mz4mz0");</style>
<style media="all">
  @import url("sites/modules/contextual/contextual.css?mz4mz0");
</style>
<style media="all">
  @import url("sites/modules/aggregator/aggregator.css?mz4mz0");
  @import url("sites/modules/book/book.css?mz4mz0");
  @import url("sites/modules/comment/comment.css?mz4mz0");
  @import url("sites/sites/all/modules/contrib/date/date_api/date.css?mz4mz0");
  @import url("sites/modules/field/theme/field.css?mz4mz0");
  @import url("sites/modules/node/node.css?mz4mz0");
  @import url("sites/sites/all/modules/contrib/picture/picture_wysiwyg.css?mz4mz0");
  @import url("sites/modules/poll/poll.css?mz4mz0");
  @import url("sites/modules/search/search.css?mz4mz0");
  @import url("sites/sites/all/modules/contrib/search_krumo/search_krumo.css?mz4mz0");
  @import url("sites/modules/user/user.css?mz4mz0");
  @import url("sites/sites/all/modules/contrib/video_filter/video_filter.css?mz4mz0");
  @import url("sites/modules/forum/forum.css?mz4mz0");
  @import url("sites/sites/all/modules/contrib/views/css/views.css?mz4mz0");
  @import url("sites/sites/all/modules/contrib/admin_menu/admin_menu.css?mz4mz0");
  @import url("sites/sites/all/modules/contrib/admin_menu/admin_menu.uid1.css?mz4mz0");
</style>
<style media="all">
  @import url("sites/sites/all/modules/contrib/ctools/css/ctools.css?mz4mz0");
  @import url("sites/sites/all/modules/contrib/panels/css/panels.css?mz4mz0");
  @import url("sites/sites/all/modules/contrib/panels/plugins/layouts/twocol_stacked/twocol_stacked.css?mz4mz0");
  @import url("sites/sites/all/themes/mothership/mothership/templates/panels//mothership-html5page/mothership-html5page.admin.css?mz4mz0");
</style>
<style media="all">
  @import url("sites/themes/stark/layout.css?mz4mz0");
</style>
					    </code></pre>

					  </section>
					  <section>
					    <h1>sobrecarga css</h1>
					    <h3>5 classes para cada uno de los campos</h3>

					    <pre><code>
<div class="field field-something field-even_more another-field-cause-im-drupal">
    El valor relevante
</div>

					    </code></pre>

					  </section>
					  <section>
					    <h1>Uso masivo de phptemplate</h1>
					    <h3>más de 5000 líneas de PHP en plantillas sin despeinarnos.</h3>
					  </section>
					  <section>
					    <h1>y demás lindezas</h1>
					    <ul>
					    	<li>Theme functions</li>
					    	<li>Difícil comprensión para no-expertos</li>
					    	<li>Poco interés por el CSS</li>
					    	<li>...</li>
					    </ul>

					  </section>
				</section>

				<section data-background="images/sea-beach-sun-sunshine-large.jpg">
					<h4>pero...</h4>
					<h1>drupal 8 está aquí!</h1>
					<p class="fragment" style="color: white">
						...o casi.
					</p>
				</section>

				<section>
					<section>
						<h1>Cambios en la capa de theme</h1>
					</section>
					<section>
            <h2 class="minus">Template process layer</h2>
            <p class="fragment">…es historia!</p>
            <aside class="notes">
              <p>5:00 - 8:00</p>
              <ul>
                <li>El principal motivo de esta capa era para insertar cadenas en HTML</li>
                <li>Drupal 8 prefiere el proceso perezoso renderizándolo lo más tarde posible y pudiendo así ser alterado también desde la plantilla directamente.</li>
              </ul>
            </aside>
          </section>

          <section>
            <h2 class="minus">Theme functions</h2>
            <p class="fragment">…están siendo convertidas a plantillas…<br>
            <span class="fragment">(y en otros formatos).</span>
            </p>
            <p class="fragment">Solamente quedan 12! <a href="http://dgo.to/2348381">http://dgo.to/2348381</a></p>
            <aside class="notes">
              <p>8:00 - 11:00</p>
              <li>Las funciones de theme son tan de Drupal 7</li>
              <li>El marcado pertenece a las plantillas, no a las variables de tipo String</li>
              <li>Restan 12 por convertir.</li>
            </aside>
          </section>

          <section>
            <h2 class="plus">Theme suggestion hooks</h2>
            <small>Drupal 7:</small>
            <pre><code data-trim class="language-php">
/**
 * Implements hook_preprocess_HOOK() for node templates.
 */
function MYTHEME_preprocess_node(&$variables) {
  $variables['theme_hook_suggestions'][] = 'node__' . 'my_first_suggestion';
  $variables['theme_hook_suggestions'][] = 'node__' . 'my_second_more_specific_suggestion';
}
</code></pre>

            <small>Drupal 8:</small>
            <pre><code data-trim class="language-php">
/**
 * Implements hook_theme_suggestions_HOOK_alter() for node templates.
 */
function MYTHEME_theme_suggestions_node_alter(array &$suggestions, array $variables) {
  $suggestions[] = 'node__' . 'my_first_suggestion';
  $suggestions[] = 'node__' . 'my_second_suggestion';
}
</code></pre>
            <aside class="notes">
              <p>11:00 - 14:00</p>
              <li>In Drupal 7 you could manipulate theme suggestions during preprocess, but by this point it might already be too late, or you've already done unnecessary preprocessing.</li>
              <li>Drupal 8 splits out the manipulation of theme hook (template) suggestions into separate hooks.</li>
              <li>You can see template suggestions in action when we talk about Twig debug in a few minutes.</li>
            </aside>
          </section>

                    <section>
                      <h3>Adiós theme(), hola <br>render arrays</h3>
                      <small>Drupal 7:</small>
                      <pre><code class="language-php">
          $variables['list'] = theme('item_list', array(
            'items' => $items,
          ));
          </code></pre>
                      <small>Drupal 8:</small>
                      <pre><code class="language-php">
          $variables['list'] = [
            '#theme' => 'item_list',
            '#items' => $items,
          ];
          </code></pre>
                      <aside class="notes">
                        <p>14:00 - 16:00</p>
                        <p>En vez de la variable <strong>list</strong> siendo una cadena de HTML, es un render array que es pasado a la plantilla y renderizado desde allí.</p>
                      </aside>
                    </section>

				</section>

				        <section>

				          <section>
				            <h2>Atributos</h2>

				            <div>
				              <small>Todos los atributos del HTML:</small>
				              <pre><code class="language-twig">&lt;div{{ attributes }}&gt;</code></pre>
				            </div>

				            <div class="fragment current-show">
				              <small>Cuidado con el primer espacio en blanco:</small>
				              <pre><code class="language-twig">&lt;div {{ attributes }}&gt;</code></pre>
				            </div>
				            <div class="fragment">
				              <small>Este espacio se sumará quedando un código feo</small>
				              <pre class="language-twig"><code class="language-twig">&lt;div✖{{ attributes }}&gt;</code></pre>
				            </div>

				            <div class="fragment">
				              <small>Dividiendo el atributo class</small>
				              <pre><code class="language-twig">&lt;div class="myclass {{ attributes.class }}"{{ attributes|without('class') }}&gt;</code></pre>
				            </div>
				            <aside class="notes">
				              <p>16:00 - 19:00</p>
				              <p>Attributes contain the attributes and also know how to print them properly. If you are printing the entire set of attributes, don't prepend a space.
				            </aside>
				          </section>

				          <section>
				            <h2>Atributos II</h2>

				            <div>
				              Manipulación de Class:
				              <pre><code class="language-twig">&lt;div{{ attributes.addClass('hola').removeClass('adiós') }}&gt;</code></pre>
				            </div>

				            <div class="fragment">
				              Testing:
				              <pre><code class="language-twig">{% if attributes.hasClass('field-label-inline') %}
  {# Realizar algún código personalizado para la etiqueta inline. #}
{% endif %}</code></pre>
				            </div>
				            <aside class="notes">
				              <p>19:00 - 21:00</p>
				            </aside>
				          </section>

				          <section>
				            <h2>Atributos III</h2>

				            <div>
				              Establecer un atributo:
				              <pre><code class="language-twig">&lt;div{{ attributes.setAttribute('id', 'eye-d') }}&gt;</code></pre>
				            </div>

				            <div>
				              Borrar un atributo:
				              <pre><code class="language-twig">&lt;div{{ attributes.removeAttribute('id') }}&gt;</code></pre>
				            </div>
				            <aside class="notes">
				              <p>21:00 - 21:30</p>
				            </aside>
				          </section>

				          <section>
				            <h3>Imprime lo que quieras, cuando quieras</h3>

				            <div>
				              <div class="fragment l-fifty">
				                <h4>Drupal 7:</h4>
				                <pre><code class="language-php">
// Ocultamos los comentarios y los links
// para imprimirlos después.
hide($content['comments']);
hide($content['links']);
print render($content);
// Render llama a show() en el elemento.
print render($content['links']);
// Para devolver los enlaces con el contenido.
show($content['links']);
// Imprime el contenido con enlaces pero todavía
// sin comentarios :(
print render($content);
</code></pre>
</div>
				              <div class="fragment l-fifty">
				                <h4>Drupal 8:</h4>
				                <pre><code class="language-twig">{# Imprime el contenido sin comentarios ni enlaces #}
{{ content|without('comments', 'links') }}

{# Imprime solamente los enlaces #}
{{ content.links }}

{# Imprime todo sin los comentarios! #}
{{ content|without('comments') }}

{# Imprime todo YUJU :) #}
{{ content }}
</code></pre>
				              </div>

				            </div>
				            <aside class="notes">
				              <p>21:30 - 23:00</p>
				            </aside>
				          </section>


				        </section>

				        <section>

				          <section class="twig">
				            <h2 class="plus">Uy sí, y Twig!</h2>
				            <p class="fragment">Creo que lo habréis notado… 😉</p>
				            <aside class="notes">
				              <p>23:00 - 25:00</p>
				              <ul>
				                <li>Twig is a flexible, fast, and secure template engine for PHP.</li>
				                <li>The Twig engine and initial integration code was committed during BADCamp in November 2012.</li>
				                <li>The conversions of .tpl.php to .html.twig files were committed during DrupalCon Portland in May 2013 and Twig is now the default template engine for Drupal 8.</li>
				              </ul>
				            </aside>
				          </section>
				          <section>
				            <small>services.yml:</small>
				            <pre><code class="language-yaml">parameters:
  twig.config:
    debug: true</code></pre>
            <small>Ejemplo de código:</small>
            <pre><code data-trim class="language-markup">
&lt;!-- THEME DEBUG --&gt;
&lt;!-- THEME HOOK: 'block' --&gt;
&lt;!-- FILE NAME SUGGESTIONS:
   * block--bartik-powered.html.twig
   * block--system-powered-by-block.html.twig
   * block--system.html.twig
   x block.html.twig
--&gt;
&lt;!-- BEGIN OUTPUT from 'core/modules/block/templates/block.html.twig' --&gt;
&lt;div class=&quot;block block-system contextual-region&quot; id=&quot;block-bartik-powered&quot; role=&quot;complementary&quot;&gt;
  &lt;div data-contextual-id=&quot;block:block=bartik_powered:&quot;&gt;&lt;/div&gt;
  &lt;div class=&quot;content&quot;&gt;
    &lt;span&gt;Powered by &lt;a href=&quot;http://drupal.org&quot;&gt;Drupal&lt;/a&gt;&lt;/span&gt;
  &lt;/div&gt;
&lt;/div&gt;
&lt;!-- END OUTPUT from 'core/modules/block/templates/block.html.twig' --&gt;
</code></pre>
				            <aside class="notes">
				              <p>25:00 - 27:00</p>
				            </aside>
				          </section>

				          <section>
				            <h3>Drupal 7.33+ también!!</h3>
				            <small>settings.php:</small>
				            <pre><code class="language-php">$conf['theme_debug'] = TRUE;</code></pre>
				            <small>Example output:</small>
				            <pre><code data-trim class="language-markup">
&lt;!-- THEME DEBUG --&gt;
&lt;!-- CALL: theme('block') --&gt;
&lt;!-- FILE NAME SUGGESTIONS:
   * block--system--powered-by.tpl.php
   * block--system.tpl.php
   * block--footer.tpl.php
   x block.tpl.php
--&gt;
&lt;!-- BEGIN OUTPUT from 'modules/block/block.tpl.php' --&gt;
&lt;div id=&quot;block-system-powered-by&quot; class=&quot;block block-system&quot;&gt;
  &lt;div class=&quot;content&quot;&gt;
    &lt;span&gt;Powered by &lt;a href=&quot;https://www.drupal.org&quot;&gt;Drupal&lt;/a&gt;&lt;/span&gt;
  &lt;/div&gt;
&lt;/div&gt;
&lt;!-- END OUTPUT from 'modules/block/block.tpl.php' --&gt;
</code></pre>
				            <aside class="notes">
				              <p>27:00 - 28:00</p>
				            </aside>
				          </section>
                  <section>
                    <h2>Twig magic</h2>
                    <p><code class="language-twig">{{ sandwich.cheese }}</code></p>
<pre><code data-trim class="language-php">
// Valor de un Array.
$sandwich['cheese'];
// Propiedad de un objeto.
$sandwich->cheese;
// También para el método mágico.
$sandwich->__isset('cheese'); &amp;&amp; $sandwich->__get('cheese');
// Para un método de un objeto.
$sandwich->cheese();
// Para un objeto obtenido con la convención get.
$sandwich->getCheese();
// Objeto is convención método.
$sandwich->isCheese();
// Método dinámico.
$sandwich->__call('cheese');
</code></pre>

        <aside class="notes">
          <p>38:00 - 40:00</p>
          <p>Show Kint demo.</p>
          <ul>
            <li>checks if <code>sandwich</code> is an array and <code>cheese</code> a valid element;</li>
            <li>if not, and if <code>sandwich</code> is an object, checks that <code>cheese</code> is a valid property;</li>
            <li>if not, and if <code>sandwich</code> is an object, checks that <code>cheese</code> is a valid method;</li>
            <li>if not, and if <code>sandwich</code> is an object, checks that <code>getBar</code> is a valid method;</li>
            <li>if not, and if <code>sandwich</code> is an object, checks that <code>isBar</code> is a valid method;</li>
            <li>if not, returns a <code>null</code> value.</li>
          </ul>
        </aside>
                  </section>
                  <section id="autoescape" class="title-slide">
          <h2>Autoescape</h2>
          <div class="fragment">
            <pre><code data-trim class="language-php">
              $user->field_first_name = "&lt;script&gt;alert('XSS')&lt;/script&gt;";
</code></pre>
          </div>

          <div>
            <div class="fragment">
              <small>Drupal 7:</small>
              <pre><code data-trim class="language-php">MAL <span>  &lt;?php print $user->field_first_name; ?&gt;</span></code></pre>
              <pre><code data-trim class="language-php">BIEN <span> &lt;?php print check_plain($user->field_first_name); ?&gt;</span></code></pre>
            </div>
            <div class="fragment">
              <small>Drupal 8:</small>
              <pre><code data-trim class="language-twig">BIEN <span>{{ user.field_first_name }}</span></code></pre>
              <pre><code data-trim class="language-twig">MAL <span> {{ user.field_first_name|raw }}</span></code></pre>
            </div>
          </div>

        </section>
				        </section>
				        <section>
				        	<section>
				        		<h1><i class="fa fa-briefcase"></i> Classy</h1>
				        		<h3>un nuevo base theme <em>amigo</em></h4>
				        		<aside>
				        			Comentar el motivo por el cual se ha quitado todas las clases de core directamente. Para fomentar la posible escalabilidad futura con otro nuevo classy 2.
				        		</aside>
				        	</section>
				        	<section>
				        		<small>Drupal 7</small>
				        		<h2>Theme Stark</h2>
				        		<h3 class="fragment">HTML + class="foo"</h3>
				        		<small>Drupal 8</small>
				        		<h2 class="fragment">Theme Stark + <i class="fa fa-briefcase"></i> Classy</h2>
				        		<h3 class="fragment">HTML + class="foo"</h3>
				        	</section>
				        	<section>
				        		<h2>¿Nuestro theme?</h2>
				        		<h3 class="fragment">Usando solamente <i class="fa fa-bullseye"></i>
 Core</h3>
				        		<pre class="fragment"><code data-trim class="language-twig"><div> {{{ code }} </div> </code></pre>
				        		<h3 class="fragment">Con <i class="fa fa-briefcase"></i> Classy</h3>
				        		<pre class="fragment"><code data-trim class="language-twig"><div class="node node—contentype"> {{{ code }} </div> </code></pre>
				        	</section>
				        	<section>
				        		<h2><i class="fa fa-briefcase"></i> Classy <i class="fa fa-folder-open-o"></i>
</h2>
<h3>Organización por tipos de plantillas</h3>
				        		<img src="images/classy_folder.jpg">
				        	</section>
				        	<section>
				        		<h2>Definir <i class="fa fa-briefcase"></i> Classy como Basetheme
</h2>
<small>*.info.yml</small>
<pre ><code data-trim class="language-twig">base theme: classy</code></pre>

				        	</section>
				        </section>
				        <section>
				        	<section>
				        		<h1><i class="fa fa-cog"></i>
 Configurando un Theme</h1>
				        	</section>
				        	<section>
				        		<h2>¿Dónde viven ahora?</h2>
				        		<h3>[root]/themes/[theme_name]</h3>
				        	</section>
				        	<section>
				        		<h2>Archivos de configuración</h2>
				        		<ul>
				        			<li>*.info.yml</li>
				        			<li>*.libraries.yml</li>
				        			<li>*.breakpoints.yml</li>
				        			<li>*.theme.yml</li>
				        		</ul>
				        	</section>
				        </section>
				        <section>
				        	<section>
				        		<h2>Gracias!</h2>
				        		<h1>That's all folks</h1>
				        		<h3>¿Preguntas?</h3>
				        		<p><img src="images/questions.png" style="float: right; width: 40%; margin-top: -2em"><i class="fa fa-envelope-o"></i>
pako@ymbra.com<br>
<i class="fa fa-twitter-square"></i>
@pakmanlh</p>
				        	</section>
				        </section>

			</div>

		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>

			// Full list of configuration options available at:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: false,
				progress: true,
				history: true,
				center: true,

				transition: 'slide', // none/fade/slide/convex/concave/zoom

				// Optional reveal.js plugins
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, condition: function() { return !!document.querySelector( 'pre code' ); }, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/zoom-js/zoom.js', async: true },
					{ src: 'plugin/notes/notes.js', async: true }
				]
			});

		</script>

	</body>
</html>
